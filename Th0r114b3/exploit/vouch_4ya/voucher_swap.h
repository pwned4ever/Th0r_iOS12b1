/*
 * voucher_swap.h
 * Brandon Azad
 */
#ifndef VOUCHER_SWAP__VOUCHER_SWAP_H_
#define VOUCHER_SWAP__VOUCHER_SWAP_H_

/*
 * voucher_swap
 *
 * Description:
 * 	Run the voucher_swap exploit.
 */
#include <stdbool.h>
#include <mach/mach.h>
#include "common.h"

//extern mach_port_t tfp0;
extern mach_port_t tipizer0;
extern uint64_t task_port_kaddr;
extern uint64_t mynewvouchSbase;
extern kptr_t sharekernbaseVS;

extern uint64_t VStask_ipc_space;
extern uint64_t newIOSURFACEROOTUSERCLIENT_portVS;
static uint64_t newIOSURFACEROOTUSERCLIENT_vtabVS;
extern uint64_t VStask_port_kaddr;
extern uint64_t newkernprocvs;
extern mach_port_t newClientVS;
extern uint64_t newkern_ucredVS;
extern uint64_t newself_ucredVS;
extern uint64_t new_self_ucreds_VS;

extern uint64_t VSourproc;

//extern uint64_t task_port_address;
extern uint64_t selfproc;
extern uint64_t ucred;
extern uint64_t cr_label;

//extern uint64_t cached_task_self_addr;
mach_port_t voucher_swap(void);

//extern uint64_t current_task;

/*
 * kernel_read
 *
 * Description:
 *     Read data from kernel memory.
 */
#endif
